(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-38fd0fae"],{"04d1":function(e,t,n){var r=n("342f"),i=r.match(/firefox\/(\d+)/i);e.exports=!!i&&+i[1]},2909:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("6b75");function i(e){if(Array.isArray(e))return Object(r["a"])(e)}n("a4d3"),n("e01a"),n("d28b"),n("a630"),n("d3b7"),n("3ca3"),n("ddb0");function a(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var s=n("06c5");function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e){return i(e)||a(e)||Object(s["a"])(e)||o()}},"4e82":function(e,t,n){"use strict";var r=n("23e7"),i=n("1c0b"),a=n("7b0b"),s=n("50c4"),o=n("d039"),c=n("addb"),u=n("a640"),l=n("04d1"),d=n("d998"),f=n("2d00"),h=n("512c"),v=[],p=v.sort,b=o((function(){v.sort(void 0)})),m=o((function(){v.sort(null)})),g=u("sort"),w=!o((function(){if(f)return f<70;if(!(l&&l>3)){if(d)return!0;if(h)return h<603;var e,t,n,r,i="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)v.push({k:t+r,v:n})}for(v.sort((function(e,t){return t.v-e.v})),r=0;r<v.length;r++)t=v[r].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return"DGBEFHACIJK"!==i}})),y=b||!m||!g||!w,_=function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:String(t)>String(n)?1:-1}};r({target:"Array",proto:!0,forced:y},{sort:function(e){void 0!==e&&i(e);var t=a(this);if(w)return void 0===e?p.call(t):p.call(t,e);var n,r,o=[],u=s(t.length);for(r=0;r<u;r++)r in t&&o.push(t[r]);o=c(o,_(e)),n=o.length,r=0;while(r<n)t[r]=o[r++];while(r<u)delete t[r++];return t}})},"4ec9":function(e,t,n){"use strict";var r=n("6d61"),i=n("6566");e.exports=r("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),i)},"512c":function(e,t,n){var r=n("342f"),i=r.match(/AppleWebKit\/(\d+)\./);e.exports=!!i&&+i[1]},6566:function(e,t,n){"use strict";var r=n("9bf2").f,i=n("7c73"),a=n("e2cc"),s=n("0366"),o=n("19aa"),c=n("2266"),u=n("7dd0"),l=n("2626"),d=n("83ab"),f=n("f183").fastKey,h=n("69f3"),v=h.set,p=h.getterFor;e.exports={getConstructor:function(e,t,n,u){var l=e((function(e,r){o(e,l,t),v(e,{type:t,index:i(null),first:void 0,last:void 0,size:0}),d||(e.size=0),void 0!=r&&c(r,e[u],{that:e,AS_ENTRIES:n})})),h=p(t),b=function(e,t,n){var r,i,a=h(e),s=m(e,t);return s?s.value=n:(a.last=s={index:i=f(t,!0),key:t,value:n,previous:r=a.last,next:void 0,removed:!1},a.first||(a.first=s),r&&(r.next=s),d?a.size++:e.size++,"F"!==i&&(a.index[i]=s)),e},m=function(e,t){var n,r=h(e),i=f(t);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==t)return n};return a(l.prototype,{clear:function(){var e=this,t=h(e),n=t.index,r=t.first;while(r)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete n[r.index],r=r.next;t.first=t.last=void 0,d?t.size=0:e.size=0},delete:function(e){var t=this,n=h(t),r=m(t,e);if(r){var i=r.next,a=r.previous;delete n.index[r.index],r.removed=!0,a&&(a.next=i),i&&(i.previous=a),n.first==r&&(n.first=i),n.last==r&&(n.last=a),d?n.size--:t.size--}return!!r},forEach:function(e){var t,n=h(this),r=s(e,arguments.length>1?arguments[1]:void 0,3);while(t=t?t.next:n.first){r(t.value,t.key,this);while(t&&t.removed)t=t.previous}},has:function(e){return!!m(this,e)}}),a(l.prototype,n?{get:function(e){var t=m(this,e);return t&&t.value},set:function(e,t){return b(this,0===e?0:e,t)}}:{add:function(e){return b(this,e=0===e?0:e,e)}}),d&&r(l.prototype,"size",{get:function(){return h(this).size}}),l},setStrong:function(e,t,n){var r=t+" Iterator",i=p(t),a=p(r);u(e,t,(function(e,t){v(this,{type:r,target:e,state:i(e),kind:t,last:void 0})}),(function(){var e=a(this),t=e.kind,n=e.last;while(n&&n.removed)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),l(t)}}},"6d61":function(e,t,n){"use strict";var r=n("23e7"),i=n("da84"),a=n("94ca"),s=n("6eeb"),o=n("f183"),c=n("2266"),u=n("19aa"),l=n("861d"),d=n("d039"),f=n("1c7e"),h=n("d44e"),v=n("7156");e.exports=function(e,t,n){var p=-1!==e.indexOf("Map"),b=-1!==e.indexOf("Weak"),m=p?"set":"add",g=i[e],w=g&&g.prototype,y=g,_={},C=function(e){var t=w[e];s(w,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(b&&!l(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return b&&!l(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(b&&!l(e))&&t.call(this,0===e?0:e)}:function(e,n){return t.call(this,0===e?0:e,n),this})},x=a(e,"function"!=typeof g||!(b||w.forEach&&!d((function(){(new g).entries().next()}))));if(x)y=n.getConstructor(t,e,p,m),o.REQUIRED=!0;else if(a(e,!0)){var E=new y,k=E[m](b?{}:-0,1)!=E,A=d((function(){E.has(1)})),j=f((function(e){new g(e)})),S=!b&&d((function(){var e=new g,t=5;while(t--)e[m](t,t);return!e.has(-0)}));j||(y=t((function(t,n){u(t,y,e);var r=v(new g,t,y);return void 0!=n&&c(n,r[m],{that:r,AS_ENTRIES:p}),r})),y.prototype=w,w.constructor=y),(A||S)&&(C("delete"),C("has"),p&&C("get")),(S||k)&&C(m),b&&w.clear&&delete w.clear}return _[e]=y,r({global:!0,forced:y!=g},_),h(y,e),b||n.setStrong(y,e,p),y}},addb:function(e,t){var n=Math.floor,r=function(e,t){var s=e.length,o=n(s/2);return s<8?i(e,t):a(r(e.slice(0,o),t),r(e.slice(o),t),t)},i=function(e,t){var n,r,i=e.length,a=1;while(a<i){r=a,n=e[a];while(r&&t(e[r-1],n)>0)e[r]=e[--r];r!==a++&&(e[r]=n)}return e},a=function(e,t,n){var r=e.length,i=t.length,a=0,s=0,o=[];while(a<r||s<i)a<r&&s<i?o.push(n(e[a],t[s])<=0?e[a++]:t[s++]):o.push(a<r?e[a++]:t[s++]);return o};e.exports=r},bb2f:function(e,t,n){var r=n("d039");e.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},d998:function(e,t,n){var r=n("342f");e.exports=/MSIE|Trident/.test(r)},ee7b:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-container",{attrs:{fluid:""}},[n("b-col",[n("b-row",{staticClass:"my-1",attrs:{"align-h":"center"}},[n("div",{staticClass:"wrapper"},[e._v("\n        Confidence Threshold"),n("br"),n("input",{attrs:{type:"range",value:"90",min:"55",max:"99",step:"1"},on:{click:e.updateConfidence}}),e._v("\n        "+e._s(e.Confidence)+"%"),n("br")])]),!0===e.lowerConfidence?n("div",[e._v("\n      "+e._s(e.lowerConfidenceMessage)+"\n    ")]):e._e(),e.isBusy?n("div",{staticClass:"wrapper"},[n("Loading")],1):e._e(),n("b-row",{staticClass:"my-1",attrs:{"align-h":"center"}},[n("div",{staticClass:"wrapper"},[n("br"),e._l(e.sorted_unique_labels,(function(t){return[n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{variant:"outline-secondary",title:t[1],size:"sm",pill:""},on:{click:function(n){return e.updateMarkers(t[0])}}},[e._v("\n            "+e._s(t[0])+"\n          ")]),e._v(" Â \n        ")]}))],2)]),n("b-row",{staticClass:"my-1",attrs:{"align-h":"center"}},[!1===e.isBusy?n("div",{staticClass:"wrapper"},[n("br"),n("p",{staticClass:"text-muted"},[e._v("\n          ("+e._s(e.count_labels)+" identified objects, "+e._s(e.count_distinct_labels)+" unique)\n        ")])]):e._e()])],1),n("b-button",{attrs:{type:"button"},on:{click:function(t){return e.saveFile()}}},[e._v("\n    Download Data\n  ")]),n("br"),n("b-button",{staticClass:"text-decoration-none",attrs:{pressed:!1,size:"sm",variant:"link"},on:{click:function(t){e.showElasticsearchApiRequest=!0}}},[e._v("\n    Show API request to get these results\n  ")]),n("b-modal",{attrs:{scrollable:"",title:"SEARCH API","ok-only":""},model:{value:e.showElasticsearchApiRequest,callback:function(t){e.showElasticsearchApiRequest=t},expression:"showElasticsearchApiRequest"}},[n("label",[e._v("Request URL:")]),n("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs"}]},[n("code",{staticClass:"bash"},[e._v("GET "+e._s(e.SEARCH_ENDPOINT)+"workflow/execution")])]),n("label",[e._v("Search query:")]),n("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs",value:JSON.stringify(e.searchQuery),expression:"JSON.stringify(searchQuery)"}]},[n("code",{staticClass:"json"})]),n("label",[e._v("Sample command:")]),n("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs",value:e.curlCommand,expression:"curlCommand"}]},[n("code",{staticClass:"bash"})])])],1)},i=[],a=n("c14f"),s=n("1da1"),o=n("2909"),c=n("5530"),u=(n("a630"),n("a15b"),n("fb6a"),n("4e82"),n("e9c4"),n("4ec9"),n("b64b"),n("d3b7"),n("3ca3"),n("0643"),n("4e3e"),n("159b"),n("ddb0"),n("2b3d"),n("bf19"),n("9861"),n("2f62")),l=n("3a5e"),d={name:"ContentModeration",components:{Loading:l["a"]},props:{mediaType:{type:String,default:""}},data:function(){return{curlCommand:"",searchQuery:"",showElasticsearchApiRequest:!1,Confidence:90,high_confidence_data:[],elasticsearch_data:[],count_distinct_labels:0,count_labels:0,isBusy:!1,operator:"content_moderation",timeseries:new Map,selectedLabel:"",lowerConfidence:!1,lowerConfidenceMessage:"Try lowering confidence threshold"}},computed:Object(c["a"])(Object(c["a"])({},Object(u["b"])(["player"])),{},{sorted_unique_labels:function(){var e=this.elasticsearch_data,t=new Map;e.forEach((function(e){t.set(e.Name,t.get(e.Name)?t.get(e.Name)+1:1)}));var n=new Map(Object(o["a"])(t.entries()).slice().sort((function(e,t){return t[1]-e[1]})));return n.delete(void 0),this.countLabels(n.size,e.length),n}}),watch:{selectedLabel:function(){this.chartData()},elasticsearch_data:function(){this.chartData()}},deactivated:function(){console.log("deactivated component:",this.operator),this.selectedLabel=""},activated:function(){console.log("activated component:",this.operator),this.fetchAssetData()},mounted:function(){this.getCurlCommand()},beforeDestroy:function(){this.high_confidence_data=[],this.elasticsearch_data=[],this.count_distinct_labels=0,this.count_labels=0},methods:{getCurlCommand:function(){this.searchQuery="AssetId:"+this.$route.params.asset_id+" Confidence:>"+this.Confidence+" Operator:"+this.operator,this.curlCommand="awscurl -X GET --profile default --service es --region "+this.AWS_REGION+" '"+this.SEARCH_ENDPOINT+"/_search?q="+encodeURIComponent(this.searchQuery)+"'"},countLabels:function(e,t){this.count_distinct_labels=e,this.count_labels=t},saveFile:function(){var e=this.elasticsearch_data,t=new Blob([JSON.stringify(e)],{type:"text/plain"}),n=document.createEvent("MouseEvents"),r=document.createElement("a");r.download="data.json",r.href=window.URL.createObjectURL(t),r.dataset.downloadurl=["text/json",r.download,r.href].join(":"),n.initEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),r.dispatchEvent(n)},updateConfidence:function(e){this.isBusy=!this.isBusy,this.Confidence=e.target.value,"video"===this.mediaType&&this.player.markers.removeAll(),this.getCurlCommand(),this.fetchAssetData()},updateMarkers:function(e){if(this.selectedLabel!==e){this.selectedLabel=e;var t=[],n=this.elasticsearch_data;n.forEach((function(n){n.Name===e&&t.push({time:n.Timestamp/1e3,text:n.Name,overlayText:n.Name})})),"video"===this.mediaType&&(this.player.markers.removeAll(),this.player.markers.add(t))}else this.selectedLabel=""},fetchAssetData:function(){var e=this;return Object(s["a"])(Object(a["a"])().m((function t(){var n,r,i,s,o,c,u,l,d,f;return Object(a["a"])().w((function(t){while(1)switch(t.n){case 0:return n="contentAnalysisElasticsearch",r="/_search",i={headers:{"Content-Type":"application/json"},queryStringParameters:{q:e.searchQuery,default_operator:"AND",size:1e4}},t.n=1,e.$Amplify.API.get(n,r,i);case 1:if(s=t.v,s){t.n=2;break}e.showElasticSearchAlert=!0,t.n=4;break;case 2:return o=[],t.n=3,s;case 3:if(c=t.v,u=c.hits.hits,l=u.length,0===l&&e.Confidence>55)e.lowerConfidence=!0,e.lowerConfidenceMessage="Try lowering confidence threshold";else for(e.lowerConfidence=!1,d=0,f=l;d<f;d++)o.push(u[d]._source);e.elasticsearch_data=JSON.parse(JSON.stringify(o)),e.isBusy=!1;case 4:return t.a(2)}}),t)})))()},chartData:function(){var e=new Map;function t(t){e.has(t)?e.set(t,{x:t,y:e.get(t).y+1}):e.set(t,{x:t,y:1})}var n=this.elasticsearch_data;n.forEach(function(e){var n=Math.round(e.Timestamp);this.selectedLabel?e.Name===this.selectedLabel&&t(n):t(n)}.bind(this));var r=new Map(Object(o["a"])(e.entries()).slice().sort((function(e,t){return e[0]-t[0]}))),i=Array.from(r.values());this.$store.commit("updateTimeseries",i),this.$store.commit("updateSelectedLabel",this.selectedLabel)}}},f=d,h=n("2877"),v=Object(h["a"])(f,r,i,!1,null,null,null);t["default"]=v.exports},f183:function(e,t,n){var r=n("d012"),i=n("861d"),a=n("5135"),s=n("9bf2").f,o=n("90e3"),c=n("bb2f"),u=o("meta"),l=0,d=Object.isExtensible||function(){return!0},f=function(e){s(e,u,{value:{objectID:"O"+ ++l,weakData:{}}})},h=function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,u)){if(!d(e))return"F";if(!t)return"E";f(e)}return e[u].objectID},v=function(e,t){if(!a(e,u)){if(!d(e))return!0;if(!t)return!1;f(e)}return e[u].weakData},p=function(e){return c&&b.REQUIRED&&d(e)&&!a(e,u)&&f(e),e},b=e.exports={REQUIRED:!1,fastKey:h,getWeakData:v,onFreeze:p};r[u]=!0}}]);
//# sourceMappingURL=chunk-38fd0fae.f260ddfd.js.map