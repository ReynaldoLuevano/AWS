(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2302c3"],{eac4:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.isBusy?a("div",{staticClass:"wrapper"},[a("Loading")],1):a("div",{staticClass:"wrapper"},[a("b-table",{attrs:{id:"shotTable",responsive:"",fixed:"",items:e.elasticsearch_data,"per-page":e.perPage,"current-page":e.currentPage,fields:e.fields,"sort-by":e.sortBy},scopedSlots:e._u([{key:"cell(Index)",fn:function(t){return[a("b-button",{attrs:{variant:"link"},on:{click:function(a){return e.setPlayerTime(t.item.EndTimestamp,t.item.StartTimestamp)}}},[e._v("\n          "+e._s(t.item.Index)+"\n        ")])]}}])}),a("b-pagination",{attrs:{align:"center","per-page":e.perPage,"total-rows":e.rows,"aria-controls":"shotTable"},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}}),a("b-button",{attrs:{type:"button"},on:{click:function(t){return e.saveFile()}}},[e._v("\n      Download Data\n    ")]),a("br"),a("b-button",{staticClass:"text-decoration-none",attrs:{pressed:!1,size:"sm",variant:"link"},on:{click:function(t){e.showElasticsearchApiRequest=!0}}},[e._v("\n      Show API request to get these results\n    ")]),a("b-modal",{attrs:{scrollable:"",title:"SEARCH API","ok-only":""},model:{value:e.showElasticsearchApiRequest,callback:function(t){e.showElasticsearchApiRequest=t},expression:"showElasticsearchApiRequest"}},[a("label",[e._v("Request URL:")]),a("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs"}]},[a("code",{staticClass:"bash"},[e._v("GET "+e._s(e.ELASTICSEARCH_ENDPOINT)+"workflow/execution")])]),a("label",[e._v("Search query:")]),a("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs",value:JSON.stringify(e.searchQuery),expression:"JSON.stringify(searchQuery)"}]},[a("code",{staticClass:"json"})]),a("label",[e._v("Sample command:")]),a("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs",value:e.curlCommand,expression:"curlCommand"}]},[a("code",{staticClass:"bash"})])])],1)])},n=[],r=a("c14f"),i=a("1da1"),o=a("5530"),c=(a("a15b"),a("e9c4"),a("b64b"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("bf19"),a("9861"),a("3a5e")),l=a("2f62"),u={name:"ShotDetection",components:{Loading:c["a"]},props:{mediaType:{type:String,default:""}},data:function(){return{curlCommand:"",searchQuery:"",showElasticsearchApiRequest:!1,sortBy:"Index",currentPage:1,perPage:10,endTimestamp:null,fields:[{Index:{label:"Shot Number",sortable:!0}},{StartTimecodeSMPTE:{label:"Start",sortable:!1}},{EndTimecodeSMPTE:{label:"End",sortable:!1}},{DurationSMPTE:{label:"Duration",sortable:!0}},{key:"Confidence",sortable:!0}],elasticsearch_data:[],isBusy:!1,operator:"shot_detection"}},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(l["b"])(["player"])),Object(l["b"])(["current_time"])),{},{rows:function(){return this.elasticsearch_data.length}}),watch:{current_time:function(e){null!=this.endTimestamp&&(e==this.endTimestamp||e>this.endTimestamp)&&(this.player.pause(),this.endTimestamp=null)}},deactivated:function(){console.log("deactivated component:",this.operator)},activated:function(){console.log("activated component:",this.operator),this.fetchAssetData()},mounted:function(){this.getCurlCommand()},beforeDestroy:function(){this.elasticsearch_data=[]},methods:{setPlayerTime:function(e,t){this.endTimestamp=e/1e3;var a=t/1e3;this.player.currentTime(a),this.player.play()},getCurlCommand:function(){this.searchQuery="AssetId:"+this.$route.params.asset_id+" Operator:"+this.operator,this.curlCommand="awscurl -X GET --profile default --service es --region "+this.AWS_REGION+" '"+this.ELASTICSEARCH_ENDPOINT+"/_search?q="+encodeURIComponent(this.searchQuery)+"'"},saveFile:function(){var e=JSON.stringify(this.elasticsearch_data),t=new Blob([e],{type:"text/plain"}),a=document.createEvent("MouseEvents"),s=document.createElement("a");s.download="data.json",s.href=window.URL.createObjectURL(t),s.dataset.downloadurl=["text/json",s.download,s.href].join(":"),a.initEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),s.dispatchEvent(a)},fetchAssetData:function(){var e=this;return Object(i["a"])(Object(r["a"])().m((function t(){var a,s,n,i,o,c,l,u,d;return Object(r["a"])().w((function(t){while(1)switch(t.n){case 0:return"AssetId:"+e.$route.params.asset_id+" Operator:"+e.operator,a="contentAnalysisElasticsearch",s="/_search",n={headers:{"Content-Type":"application/json"},queryStringParameters:{q:e.searchQuery,default_operator:"AND",size:1e4}},t.n=1,e.$Amplify.API.get(a,s,n);case 1:if(i=t.v,console.log(i),i){t.n=2;break}e.showElasticSearchAlert=!0,t.n=4;break;case 2:return o=[],t.n=3,i;case 3:if(c=t.v,l=c.hits.hits,0===l.length&&e.Confidence>55)e.lowerConfidence=!0,e.lowerConfidenceMessage="Try lowering confidence threshold";else for(e.lowerConfidence=!1,u=0,d=l.length;u<d;u++)o.push(l[u]._source);e.elasticsearch_data=JSON.parse(JSON.stringify(o)),e.isBusy=!1;case 4:return t.a(2)}}),t)})))()}}},d=u,h=a("2877"),p=Object(h["a"])(d,s,n,!1,null,null,null);t["default"]=p.exports}}]);
//# sourceMappingURL=chunk-2d2302c3.9a781fb8.js.map