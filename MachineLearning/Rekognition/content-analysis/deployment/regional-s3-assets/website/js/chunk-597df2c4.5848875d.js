(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-597df2c4"],{"04d1":function(e,t,n){var i=n("342f"),r=i.match(/firefox\/(\d+)/i);e.exports=!!r&&+r[1]},2909:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("6b75");function r(e){if(Array.isArray(e))return Object(i["a"])(e)}n("a4d3"),n("e01a"),n("d28b"),n("a630"),n("d3b7"),n("3ca3"),n("ddb0");function a(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var s=n("06c5");function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e){return r(e)||a(e)||Object(s["a"])(e)||o()}},"4e82":function(e,t,n){"use strict";var i=n("23e7"),r=n("1c0b"),a=n("7b0b"),s=n("50c4"),o=n("d039"),c=n("addb"),d=n("a640"),l=n("04d1"),u=n("d998"),h=n("2d00"),f=n("512c"),v=[],p=v.sort,b=o((function(){v.sort(void 0)})),m=o((function(){v.sort(null)})),g=d("sort"),x=!o((function(){if(h)return h<70;if(!(l&&l>3)){if(u)return!0;if(f)return f<603;var e,t,n,i,r="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)v.push({k:t+i,v:n})}for(v.sort((function(e,t){return t.v-e.v})),i=0;i<v.length;i++)t=v[i].k.charAt(0),r.charAt(r.length-1)!==t&&(r+=t);return"DGBEFHACIJK"!==r}})),w=b||!m||!g||!x,y=function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:String(t)>String(n)?1:-1}};i({target:"Array",proto:!0,forced:w},{sort:function(e){void 0!==e&&r(e);var t=a(this);if(x)return void 0===e?p.call(t):p.call(t,e);var n,i,o=[],d=s(t.length);for(i=0;i<d;i++)i in t&&o.push(t[i]);o=c(o,y(e)),n=o.length,i=0;while(i<n)t[i]=o[i++];while(i<d)delete t[i++];return t}})},"4ec9":function(e,t,n){"use strict";var i=n("6d61"),r=n("6566");e.exports=i("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),r)},"512c":function(e,t,n){var i=n("342f"),r=i.match(/AppleWebKit\/(\d+)\./);e.exports=!!r&&+r[1]},6566:function(e,t,n){"use strict";var i=n("9bf2").f,r=n("7c73"),a=n("e2cc"),s=n("0366"),o=n("19aa"),c=n("2266"),d=n("7dd0"),l=n("2626"),u=n("83ab"),h=n("f183").fastKey,f=n("69f3"),v=f.set,p=f.getterFor;e.exports={getConstructor:function(e,t,n,d){var l=e((function(e,i){o(e,l,t),v(e,{type:t,index:r(null),first:void 0,last:void 0,size:0}),u||(e.size=0),void 0!=i&&c(i,e[d],{that:e,AS_ENTRIES:n})})),f=p(t),b=function(e,t,n){var i,r,a=f(e),s=m(e,t);return s?s.value=n:(a.last=s={index:r=h(t,!0),key:t,value:n,previous:i=a.last,next:void 0,removed:!1},a.first||(a.first=s),i&&(i.next=s),u?a.size++:e.size++,"F"!==r&&(a.index[r]=s)),e},m=function(e,t){var n,i=f(e),r=h(t);if("F"!==r)return i.index[r];for(n=i.first;n;n=n.next)if(n.key==t)return n};return a(l.prototype,{clear:function(){var e=this,t=f(e),n=t.index,i=t.first;while(i)i.removed=!0,i.previous&&(i.previous=i.previous.next=void 0),delete n[i.index],i=i.next;t.first=t.last=void 0,u?t.size=0:e.size=0},delete:function(e){var t=this,n=f(t),i=m(t,e);if(i){var r=i.next,a=i.previous;delete n.index[i.index],i.removed=!0,a&&(a.next=r),r&&(r.previous=a),n.first==i&&(n.first=r),n.last==i&&(n.last=a),u?n.size--:t.size--}return!!i},forEach:function(e){var t,n=f(this),i=s(e,arguments.length>1?arguments[1]:void 0,3);while(t=t?t.next:n.first){i(t.value,t.key,this);while(t&&t.removed)t=t.previous}},has:function(e){return!!m(this,e)}}),a(l.prototype,n?{get:function(e){var t=m(this,e);return t&&t.value},set:function(e,t){return b(this,0===e?0:e,t)}}:{add:function(e){return b(this,e=0===e?0:e,e)}}),u&&i(l.prototype,"size",{get:function(){return f(this).size}}),l},setStrong:function(e,t,n){var i=t+" Iterator",r=p(t),a=p(i);d(e,t,(function(e,t){v(this,{type:i,target:e,state:r(e),kind:t,last:void 0})}),(function(){var e=a(this),t=e.kind,n=e.last;while(n&&n.removed)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),l(t)}}},"6d61":function(e,t,n){"use strict";var i=n("23e7"),r=n("da84"),a=n("94ca"),s=n("6eeb"),o=n("f183"),c=n("2266"),d=n("19aa"),l=n("861d"),u=n("d039"),h=n("1c7e"),f=n("d44e"),v=n("7156");e.exports=function(e,t,n){var p=-1!==e.indexOf("Map"),b=-1!==e.indexOf("Weak"),m=p?"set":"add",g=r[e],x=g&&g.prototype,w=g,y={},_=function(e){var t=x[e];s(x,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(b&&!l(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return b&&!l(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(b&&!l(e))&&t.call(this,0===e?0:e)}:function(e,n){return t.call(this,0===e?0:e,n),this})},C=a(e,"function"!=typeof g||!(b||x.forEach&&!u((function(){(new g).entries().next()}))));if(C)w=n.getConstructor(t,e,p,m),o.REQUIRED=!0;else if(a(e,!0)){var E=new w,k=E[m](b?{}:-0,1)!=E,A=u((function(){E.has(1)})),T=h((function(e){new g(e)})),B=!b&&u((function(){var e=new g,t=5;while(t--)e[m](t,t);return!e.has(-0)}));T||(w=t((function(t,n){d(t,w,e);var i=v(new g,t,w);return void 0!=n&&c(n,i[m],{that:i,AS_ENTRIES:p}),i})),w.prototype=x,x.constructor=w),(A||B)&&(_("delete"),_("has"),p&&_("get")),(B||k)&&_(m),b&&x.clear&&delete x.clear}return y[e]=w,i({global:!0,forced:w!=g},y),f(w,e),b||n.setStrong(w,e,p),w}},a573:function(e,t,n){"use strict";var i=n("23e7"),r=n("1c0b"),a=n("825a"),s=n("c5cc"),o=n("9bdd"),c=s((function(e){var t=this.iterator,n=a(this.next.call(t,e)),i=this.done=!!n.done;if(!i)return o(t,this.mapper,n.value)}));i({target:"Iterator",proto:!0,real:!0},{map:function(e){return new c({iterator:a(this),mapper:r(e)})}})},addb:function(e,t){var n=Math.floor,i=function(e,t){var s=e.length,o=n(s/2);return s<8?r(e,t):a(i(e.slice(0,o),t),i(e.slice(o),t),t)},r=function(e,t){var n,i,r=e.length,a=1;while(a<r){i=a,n=e[a];while(i&&t(e[i-1],n)>0)e[i]=e[--i];i!==a++&&(e[i]=n)}return e},a=function(e,t,n){var i=e.length,r=t.length,a=0,s=0,o=[];while(a<i||s<r)a<i&&s<r?o.push(n(e[a],t[s])<=0?e[a++]:t[s++]):o.push(a<i?e[a++]:t[s++]);return o};e.exports=i},bb2f:function(e,t,n){var i=n("d039");e.exports=!i((function(){return Object.isExtensible(Object.preventExtensions({}))}))},d81d:function(e,t,n){"use strict";var i=n("23e7"),r=n("b727").map,a=n("1dde"),s=a("map");i({target:"Array",proto:!0,forced:!s},{map:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},d998:function(e,t,n){var i=n("342f");e.exports=/MSIE|Trident/.test(i)},f183:function(e,t,n){var i=n("d012"),r=n("861d"),a=n("5135"),s=n("9bf2").f,o=n("90e3"),c=n("bb2f"),d=o("meta"),l=0,u=Object.isExtensible||function(){return!0},h=function(e){s(e,d,{value:{objectID:"O"+ ++l,weakData:{}}})},f=function(e,t){if(!r(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,d)){if(!u(e))return"F";if(!t)return"E";h(e)}return e[d].objectID},v=function(e,t){if(!a(e,d)){if(!u(e))return!0;if(!t)return!1;h(e)}return e[d].weakData},p=function(e){return c&&b.REQUIRED&&u(e)&&!a(e,d)&&h(e),e},b=e.exports={REQUIRED:!1,fastKey:f,getWeakData:v,onFreeze:p};i[d]=!0},fb30:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-container",{attrs:{fluid:""}},[n("b-col",[n("b-row",{staticClass:"my-1",attrs:{"align-h":"center"}},[n("div",{staticClass:"wrapper"},[e._v("\n        Confidence Threshold"),n("br"),n("input",{attrs:{type:"range",value:"90",min:"55",max:"99",step:"1"},on:{click:e.updateConfidence}}),e._v("\n        "+e._s(e.Confidence)+"%"),n("br")])]),!0===e.lowerConfidence?n("div",[e._v("\n      "+e._s(e.lowerConfidenceMessage)+"\n    ")]):e._e(),e.isBusy?n("div",{staticClass:"wrapper"},[n("Loading")],1):e._e(),n("b-row",{staticClass:"my-1",attrs:{"align-h":"center"}},[n("div",{staticClass:"wrapper"},[n("br"),e._l(e.sorted_unique_word_detections,(function(t){return[e.boxes_available.includes(t[0])?[n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{variant:"outline-dark",title:t[1],size:"sm",pill:""},on:{click:function(n){return e.updateMarkers(t[0])}}},[e._v("\n              "+e._s(t[0]+"*")+"\n            ")]),e._v("  \n          ")]:[n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{variant:"outline-secondary",title:t[1],size:"sm",pill:""},on:{click:function(n){return e.updateMarkers(t[0])}}},[e._v("\n              "+e._s(t[0])+"\n            ")]),e._v("  \n          ")]]}))],2)]),n("b-row",{staticClass:"my-1",attrs:{"align-h":"center"}},[!1===e.isBusy?n("div",{staticClass:"wrapper"},[n("p",{staticClass:"text-muted"},[e._v("\n          ("+e._s(e.count_words)+" identified text objects, "+e._s(e.count_distinct_words)+" unique)\n        ")]),n("hr"),n("p",{staticClass:"text-muted"},[e._v("\n          * Indicates bounding boxes are available.\n        ")])]):e._e()])],1),n("b-button",{attrs:{type:"button"},on:{click:function(t){return e.saveFile()}}},[e._v("\n    Download Data\n  ")]),n("br"),n("b-button",{staticClass:"text-decoration-none",attrs:{pressed:!1,size:"sm",variant:"link"},on:{click:function(t){e.showElasticsearchApiRequest=!0}}},[e._v("\n    Show API request to get these results\n  ")]),n("b-modal",{attrs:{scrollable:"",title:"SEARCH API","ok-only":""},model:{value:e.showElasticsearchApiRequest,callback:function(t){e.showElasticsearchApiRequest=t},expression:"showElasticsearchApiRequest"}},[n("label",[e._v("Request URL:")]),n("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs"}]},[n("code",{staticClass:"bash"},[e._v("GET "+e._s(e.SEARCH_ENDPOINT)+"workflow/execution")])]),n("label",[e._v("Search query:")]),n("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs",value:JSON.stringify(e.searchQuery),expression:"JSON.stringify(searchQuery)"}]},[n("code",{staticClass:"json"})]),n("label",[e._v("Sample command:")]),n("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs",value:e.curlCommand,expression:"curlCommand"}]},[n("code",{staticClass:"bash"})])])],1)},a=[],s=n("c14f"),o=n("1da1"),c=n("2909"),d=n("5530"),l=(n("4de4"),n("a630"),n("caad"),n("a15b"),n("d81d"),n("fb6a"),n("4e82"),n("b0c0"),n("e9c4"),n("4ec9"),n("b680"),n("b64b"),n("d3b7"),n("2532"),n("3ca3"),n("0643"),n("2382"),n("4e3e"),n("a573"),n("159b"),n("ddb0"),n("2b3d"),n("bf19"),n("9861"),n("3a5e")),u=n("2f62"),h={name:"TextDetection",components:{Loading:l["a"]},props:{mediaType:{type:String,default:""}},data:function(){return{curlCommand:"",searchQuery:"",showElasticsearchApiRequest:!1,Confidence:90,high_confidence_data:[],elasticsearch_data:[],boxes_available:[],count_distinct_words:0,count_words:0,isBusy:!1,operator:"textDetection",canvasRefreshInterval:void 0,timeseries:new Map,selectedWord:"",lowerConfidence:!1,lowerConfidenceMessage:"Try lowering confidence threshold"}},computed:Object(d["a"])(Object(d["a"])({},Object(u["b"])(["player"])),{},{sorted_unique_word_detections:function(){var e=this.elasticsearch_data;console.log(e);var t=new Map;e.forEach(function(e){"WORD"==e.Type&&t.set(e.DetectedText,t.get(e.DetectedText)?t.get(e.DetectedText)+1:1),e.BoundingBox&&this.saveBoxedDetectedText(e.DetectedText)}.bind(this));var n=new Map(Object(c["a"])(t.entries()).slice().sort((function(e,t){return t[1]-e[1]})));return n.delete(void 0),this.countDetectedWords(n.size,e.length),console.log(n),n}}),watch:{selectedWord:function(){this.chartData()},elasticsearch_data:function(){this.chartData()}},deactivated:function(){this.boxes_available=[],this.selectedWord="",clearInterval(this.canvasRefreshInterval);var e,t=document.getElementById("canvas");t&&(e=t.getContext("2d")),e&&e.clearRect(0,0,t.width,t.height)},activated:function(){this.fetchAssetData()},mounted:function(){this.getCurlCommand()},beforeDestroy:function(){this.high_confidence_data=[],this.elasticsearch_data=[],this.count_distinct_words=0,this.count_words=0,clearInterval(this.canvasRefreshInterval)},methods:{getCurlCommand:function(){this.searchQuery="AssetId:"+this.$route.params.asset_id+" Confidence:>"+this.Confidence+" Operator:"+this.operator,this.curlCommand="awscurl -X GET --profile default --service es --region "+this.AWS_REGION+" '"+this.SEARCH_ENDPOINT+"/_search?q="+encodeURIComponent(this.searchQuery)+"'"},saveBoxedDetectedText:function(e){this.boxes_available.includes(e)||this.boxes_available.push(e)},countDetectedWords:function(e,t){this.count_distinct_words=e,this.count_words=t},saveFile:function(){var e=JSON.stringify(this.elasticsearch_data),t=new Blob([e],{type:"text/plain"}),n=document.createEvent("MouseEvents"),i=document.createElement("a");i.download="data.json",i.href=window.URL.createObjectURL(t),i.dataset.downloadurl=["text/json",i.download,i.href].join(":"),n.initEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),i.dispatchEvent(n)},updateConfidence:function(e){this.isBusy=!0,this.Confidence=e.target.value,"video"===this.mediaType&&this.player.markers.removeAll(),this.getCurlCommand(),this.fetchAssetData()},updateMarkers:function(e){this.boxes_available=[],clearInterval(this.canvasRefreshInterval);var t=document.getElementById("canvas"),n=t.getContext("2d");if(n.clearRect(0,0,t.width,t.height),n.strokeStyle="red",n.font="15px Arial",n.textAlign="center",n.textBaseline="middle",n.fillStyle="red",this.selectedWord!==e){this.selectedWord=e;var r=new Map,a=[],s=this.elasticsearch_data;s.forEach(function(n){if(n.DetectedText===e&&(a.push({time:n.Timestamp/1e3,text:n.DetectedText,overlayText:n.DetectedText}),n.BoundingBox)){var s=n;if("image"===this.mediaType){var o={name:s.DetectedText,confidence:(1*s.Confidence).toFixed(2),x:s.BoundingBox.Left*t.width,y:s.BoundingBox.Top*t.height,width:s.BoundingBox.Width*t.width,height:s.BoundingBox.Height*t.height};r.set(i,[o])}else{var c=Math.round(n.Timestamp/100),d={timestamp:Math.ceil(n.Timestamp/100),name:n.DetectedText,confidence:(1*n.Confidence).toFixed(2),x:s.BoundingBox.Left*t.width,y:s.BoundingBox.Top*t.height,width:s.BoundingBox.Width*t.width,height:s.BoundingBox.Height*t.height};r.has(c)?r.get(c).push(d):r.set(c,[d])}}}.bind(this)),r.size>0&&this.drawBoxes(r),"video"===this.mediaType&&(this.player.markers.removeAll(),this.player.markers.add(a))}else this.selectedWord=""},fetchAssetData:function(){var e=this;return Object(o["a"])(Object(s["a"])().m((function t(){var n,i,r,a,o,c,d,l,u;return Object(s["a"])().w((function(t){while(1)switch(t.n){case 0:return n="contentAnalysisElasticsearch",i="/_search",r={headers:{"Content-Type":"application/json"},queryStringParameters:{q:e.searchQuery,default_operator:"AND",size:1e4}},t.n=1,e.$Amplify.API.get(n,i,r);case 1:if(a=t.v,a){t.n=2;break}e.showElasticSearchAlert=!0,t.n=4;break;case 2:return o=[],t.n=3,a;case 3:if(c=t.v,d=c.hits.hits,0===d.length&&e.Confidence>55)e.lowerConfidence=!0,e.lowerConfidenceMessage="Try lowering confidence threshold";else for(e.lowerConfidence=!1,l=0,u=d.length;l<u;l++)o.push(d[l]._source);e.elasticsearch_data=JSON.parse(JSON.stringify(o)),e.isBusy=!1;case 4:return t.a(2)}}),t)})))()},drawBoxes:function(e){var t=document.getElementById("canvas"),n=t.getContext("2d");if("image"===this.mediaType)return n.clearRect(0,0,t.width,t.height),n.beginPath(),n.strokeStyle="red",n.font="15px Arial",n.textAlign="center",n.textBaseline="middle",n.fillStyle="red",void e.forEach((function(e){var t=e[0];t&&(n.rect(t.x,t.y,t.width,t.height),n.fillText(t.name+" ("+t.confidence+"%)",t.x+t.width/2,t.y-10),n.stroke())}));void 0!==this.canvasRefreshInterval&&clearInterval(this.canvasRefreshInterval);var i=100,r=2,a=0;this.canvasRefreshInterval=setInterval(function(){a++,this.player.paused()||a%r!==0||(a=0,n.clearRect(0,0,t.width,t.height),n.beginPath(),n.strokeStyle="red",n.font="15px Arial",n.textAlign="center",n.textBaseline="middle",n.fillStyle="red");var i=Math.round(10*this.player.currentTime());if(e.has(i)){a=0,n.clearRect(0,0,t.width,t.height),n.beginPath(),n.strokeStyle="red",n.font="15px Arial",n.textAlign="center",n.textBaseline="middle",n.fillStyle="red";var s=e.get(i).map((function(e){return e.instance})).filter((function(e,t,n){return n.indexOf(e)===t}));s.forEach((function(t){var r=e.get(i).filter((function(e){return e.instance===t}));r.forEach((function(e){e&&(n.rect(e.x,e.y,e.width,e.height),n.fillText(e.name+" ("+e.confidence+"%)",e.x+e.width/2,e.y-10))}))})),n.stroke()}}.bind(this),i)},chartData:function(){var e=new Map;function t(t){e.has(t)?e.set(t,{x:t,y:e.get(t).y+1}):e.set(t,{x:t,y:1})}var n=this.elasticsearch_data;n.forEach(function(e){var n=Math.round(e.Timestamp);this.selectedWord?e.DetectedText===this.selectedWord&&t(n):t(n)}.bind(this));var i=new Map(Object(c["a"])(e.entries()).slice().sort((function(e,t){return e[0]-t[0]}))),r=Array.from(i.values());this.$store.commit("updateTimeseries",r),this.$store.commit("updateSelectedLabel",this.selectedWord)}}},f=h,v=n("2877"),p=Object(v["a"])(f,r,a,!1,null,null,null);t["default"]=p.exports}}]);
//# sourceMappingURL=chunk-597df2c4.5848875d.js.map